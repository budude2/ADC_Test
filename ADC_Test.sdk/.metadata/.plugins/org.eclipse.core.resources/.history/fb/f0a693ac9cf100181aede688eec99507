/*
 * spi.c
 *
 *  Created on: Nov 26, 2018
 *      Author: Jacob
 */

#include <xparameters.h>

#define BASE_ADDR 	XPAR_SPI_3_WIRE_0_S00_AXI_BASEADDR

// Setup register map
#define SPI_MODE 	 BASE_ADDR			// CPOL (bit 0), CPHA (bit 1)
#define SPI_CONTR 	(BASE_ADDR | 0x4)	// En (bit 0), RW (bit 1)
#define TX_CMD 		(BASE_ADDR | 0x8)
#define TX_DATA 	(BASE_ADDR | 0xC)
#define RX_DATA 	(BASE_ADDR | 0x10)

void spi_write(int regAddr, int txData)
{
	Xil_Out32(SPI_MODE, 0x03);
	Xil_Out32(TX_CMD, 0x000C);
	Xil_Out32(0x44a0000C, 0x00);
	Xil_Out32(0x44a00004, 0x03);
	Xil_Out32(0x44a00004, 0x00);
}
